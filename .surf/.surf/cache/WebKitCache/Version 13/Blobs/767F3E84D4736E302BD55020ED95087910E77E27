<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>rEFInd - ArchWiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"REFInd","wgTitle":"REFInd","wgCurRevisionId":558889,"wgRevisionId":558889,"wgArticleId":17729,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":["Pages or sections flagged with Template:Expansion","Pages or sections flagged with Template:Move","Pages or sections flagged with Template:Out of date","Boot loaders"],"wgBreakFrames":false,"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgMonthNamesShort":["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"wgRelevantPageName":"REFInd","wgRelevantArticleId":17729,"wgRequestId":"c2dbfbf6a10cafbef8b2f5ad","wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],"wgRestrictionMove":[]});mw.loader.state({"site.styles":"ready","noscript":"ready","user.styles":"ready","user":"ready","site":"ready","user.options":"ready","user.tokens":"loading","zzz.ext.archLinux.styles":"ready","skins.vector.styles.responsive":"ready","mediawiki.legacy.shared":"ready","mediawiki.legacy.commonPrint":"ready","mediawiki.sectionAnchor":"ready","mediawiki.skinning.interface":"ready","skins.vector.styles":"ready"});mw.loader.implement("user.tokens@1pa52qv",function($,jQuery,require,module){/*@nomin*/mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});
});mw.loader.load(["mediawiki.page.startup","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.toc","mediawiki.searchSuggest","skins.vector.js"]);});</script>
<link rel="stylesheet" href="/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.vector.styles%7Cskins.vector.styles.responsive%7Czzz.ext.archLinux.styles&amp;only=styles&amp;skin=vector"/>
<script async="" src="/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/load.php?debug=false&amp;lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.31.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<link rel="shortcut icon" href="/favicon.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="ArchWiki (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.archlinux.org/api.php?action=rsd"/>
<link rel="license" href="http://www.gnu.org/copyleft/fdl.html"/>
<link rel="alternate" type="application/atom+xml" title="ArchWiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom"/>
<!--[if lt IE 9]><script src="/load.php?debug=false&amp;lang=en&amp;modules=html5shiv&amp;only=scripts&amp;skin=vector&amp;sync=1"></script><![endif]-->
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-REFInd rootpage-REFInd skin-vector action-view"><div id="archnavbar" class="noprint">
    <div id="archnavbarlogo">
        <p><a id="logo" href="https://www.archlinux.org/"></a></p>
    </div>
    <div id="archnavbarmenu">
        <ul id="archnavbarlist">
                        <li id="anb-home"><a href="https://www.archlinux.org/">Home</a></li>            <li id="anb-packages"><a href="https://www.archlinux.org/packages/">Packages</a></li>            <li id="anb-forums"><a href="https://bbs.archlinux.org/">Forums</a></li>            <li id="anb-wiki" class="anb-selected"><a href="https://wiki.archlinux.org/">Wiki</a></li>            <li id="anb-bugs"><a href="https://bugs.archlinux.org/">Bugs</a></li>            <li id="anb-security"><a href="https://security.archlinux.org/">Security</a></li>            <li id="anb-aur"><a href="https://aur.archlinux.org/">AUR</a></li>            <li id="anb-download"><a href="https://www.archlinux.org/download/">Download</a></li>        </ul>
    </div>
</div>
		<div id="mw-page-base" class="noprint"></div>
		<div id="mw-head-base" class="noprint"></div>
		<div id="content" class="mw-body" role="main">
			<a id="top"></a>
			<div class="mw-indicators mw-body-content">
</div>
<h1 id="firstHeading" class="firstHeading" lang="en">rEFInd</h1>			<div id="bodyContent" class="mw-body-content">
				<div id="siteSub" class="noprint">From ArchWiki</div>				<div id="contentSub"></div>
								<div id="jump-to-nav" class="mw-jump">
					Jump to:					<a href="#mw-head">navigation</a>, 					<a href="#p-search">search</a>
				</div>
				<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output"><p><span></span>
</p>
<div class="archwiki-template-meta-related-articles-start"><p>Related articles</p><ul>
<li><a href="/index.php/Arch_boot_process" title="Arch boot process">Arch boot process</a></li>
<li><a href="/index.php/Boot_loader" class="mw-redirect" title="Boot loader">Boot loader</a></li>
<li><a href="/index.php/Unified_Extensible_Firmware_Interface" title="Unified Extensible Firmware Interface">Unified Extensible Firmware Interface</a></li>
<li><a href="/index.php/EFISTUB" title="EFISTUB">EFISTUB</a></li>
</ul></div>
<p><a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/">rEFInd</a> is a <a href="/index.php/UEFI" class="mw-redirect" title="UEFI">UEFI</a> <a href="/index.php/Boot_manager" class="mw-redirect" title="Boot manager">boot manager</a> capable of launching <a href="/index.php/EFISTUB" title="EFISTUB">EFISTUB</a> kernels. It is a fork of the no-longer-maintained rEFIt and fixes many issues with respect to non-Mac UEFI booting. It is designed to be platform-neutral and to simplify booting multiple OSes.
</p>
<div class="archwiki-template-box archwiki-template-box-note"><strong>Note:</strong> In the entire article <code><i>esp</i></code> denotes the mountpoint of the <a href="/index.php/EFI_system_partition" title="EFI system partition">EFI system partition</a> aka ESP.</div>
<div id="toc" class="toc"><div class="toctitle" lang="en" dir="ltr"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Installation"><span class="tocnumber">1</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Installing_the_rEFInd_Boot_Manager"><span class="tocnumber">2</span> <span class="toctext">Installing the rEFInd Boot Manager</span></a>
<ul>
<li class="toclevel-2 tocsection-3"><a href="#Installation_with_refind-install_script"><span class="tocnumber">2.1</span> <span class="toctext">Installation with refind-install script</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Secure_Boot"><span class="tocnumber">2.1.1</span> <span class="toctext">Secure Boot</span></a>
<ul>
<li class="toclevel-4 tocsection-5"><a href="#Using_PreLoader"><span class="tocnumber">2.1.1.1</span> <span class="toctext">Using PreLoader</span></a></li>
<li class="toclevel-4 tocsection-6"><a href="#Using_shim"><span class="tocnumber">2.1.1.2</span> <span class="toctext">Using shim</span></a>
<ul>
<li class="toclevel-5 tocsection-7"><a href="#Using_hashes"><span class="tocnumber">2.1.1.2.1</span> <span class="toctext">Using hashes</span></a></li>
<li class="toclevel-5 tocsection-8"><a href="#Using_Machine_Owner_Key"><span class="tocnumber">2.1.1.2.2</span> <span class="toctext">Using Machine Owner Key</span></a></li>
</ul>
</li>
<li class="toclevel-4 tocsection-9"><a href="#Using_your_own_keys"><span class="tocnumber">2.1.1.3</span> <span class="toctext">Using your own keys</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="#Manual_installation"><span class="tocnumber">2.2</span> <span class="toctext">Manual installation</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Upgrading"><span class="tocnumber">2.3</span> <span class="toctext">Upgrading</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#Pacman_hook"><span class="tocnumber">2.3.1</span> <span class="toctext">Pacman hook</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Configuration"><span class="tocnumber">3</span> <span class="toctext">Configuration</span></a>
<ul>
<li class="toclevel-2 tocsection-14"><a href="#Passing_kernel_parameters"><span class="tocnumber">3.1</span> <span class="toctext">Passing kernel parameters</span></a>
<ul>
<li class="toclevel-3 tocsection-15"><a href="#For_kernels_automatically_detected_by_rEFInd"><span class="tocnumber">3.1.1</span> <span class="toctext">For kernels automatically detected by rEFInd</span></a>
<ul>
<li class="toclevel-4 tocsection-16"><a href="#refind_linux.conf"><span class="tocnumber">3.1.1.1</span> <span class="toctext">refind_linux.conf</span></a></li>
<li class="toclevel-4 tocsection-17"><a href="#Without_configuration"><span class="tocnumber">3.1.1.2</span> <span class="toctext">Without configuration</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-18"><a href="#Manual_boot_stanzas"><span class="tocnumber">3.1.2</span> <span class="toctext">Manual boot stanzas</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-19"><a href="#Installation_alongside_an_existing_UEFI_Windows_installation"><span class="tocnumber">4</span> <span class="toctext">Installation alongside an existing UEFI Windows installation</span></a></li>
<li class="toclevel-1 tocsection-20"><a href="#Tools"><span class="tocnumber">5</span> <span class="toctext">Tools</span></a>
<ul>
<li class="toclevel-2 tocsection-21"><a href="#UEFI_shell"><span class="tocnumber">5.1</span> <span class="toctext">UEFI shell</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Memtest86"><span class="tocnumber">5.2</span> <span class="toctext">Memtest86</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Key_management_tools"><span class="tocnumber">5.3</span> <span class="toctext">Key management tools</span></a>
<ul>
<li class="toclevel-3 tocsection-24"><a href="#HashTool"><span class="tocnumber">5.3.1</span> <span class="toctext">HashTool</span></a></li>
<li class="toclevel-3 tocsection-25"><a href="#MokManager"><span class="tocnumber">5.3.2</span> <span class="toctext">MokManager</span></a></li>
<li class="toclevel-3 tocsection-26"><a href="#KeyTool"><span class="tocnumber">5.3.3</span> <span class="toctext">KeyTool</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-27"><a href="#GPT_fdisk_(gdisk)"><span class="tocnumber">5.4</span> <span class="toctext">GPT fdisk (gdisk)</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#iPXE"><span class="tocnumber">5.5</span> <span class="toctext">iPXE</span></a></li>
<li class="toclevel-2 tocsection-29"><a href="#fwupdate"><span class="tocnumber">5.6</span> <span class="toctext">fwupdate</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-30"><a href="#Tips_and_tricks"><span class="tocnumber">6</span> <span class="toctext">Tips and tricks</span></a>
<ul>
<li class="toclevel-2 tocsection-31"><a href="#Using_drivers_in_UEFI_shell"><span class="tocnumber">6.1</span> <span class="toctext">Using drivers in UEFI shell</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-32"><a href="#Troubleshooting"><span class="tocnumber">7</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-33"><a href="#Btrfs_subvolume_support"><span class="tocnumber">7.1</span> <span class="toctext">Btrfs subvolume support</span></a>
<ul>
<li class="toclevel-3 tocsection-34"><a href="#Auto_detection"><span class="tocnumber">7.1.1</span> <span class="toctext">Auto detection</span></a></li>
<li class="toclevel-3 tocsection-35"><a href="#Manual_boot_stanza"><span class="tocnumber">7.1.2</span> <span class="toctext">Manual boot stanza</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-36"><a href="#Apple_Macs"><span class="tocnumber">7.2</span> <span class="toctext">Apple Macs</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#VirtualBox"><span class="tocnumber">7.3</span> <span class="toctext">VirtualBox</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-38"><a href="#See_also"><span class="tocnumber">8</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="/index.php/Install" class="mw-redirect" title="Install">Install</a> the <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=refind-efi">refind-efi</a></span> package.
</p>
<h2><span class="mw-headline" id="Installing_the_rEFInd_Boot_Manager">Installing the rEFInd Boot Manager</span></h2>
<p>rEFInd has <b>read-only</b> drivers for ReiserFS, Ext2, Ext4, Btrfs, ISO-9660, HFS+, and NTFS. Additionally rEFInd can use drivers from the UEFI firmware i.e. FAT (and HFS+ on Macs or ISO-9660 on some systems).
</p>
<div class="archwiki-template-box archwiki-template-box-note"><strong>Note:</strong> Your kernel and initramfs must reside on a file system that rEFInd can read.</div>
<p>To find additional drivers see <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/drivers.html#finding">The rEFInd Boot Manager: Using EFI Drivers: Finding Additional EFI Drivers</a>.
</p><p>To use the rEFInd, you must install it to the EFI system partition either using the <a href="#Installation_with_refind-install_script">refind-install script</a> or <a href="#Manual_installation">by copying the files and setting up the boot entry manually</a>.
</p>
<h3><span class="mw-headline" id="Installation_with_refind-install_script">Installation with refind-install script</span></h3>
<p>The rEFInd package includes the <i>refind-install</i> script to simplify the process of setting rEFInd as your default EFI boot entry. The script has several options for handling differing setups and UEFI implementations. See <span class="plainlinks archwiki-template-man" title="$ man 8 refind-install"><a rel="nofollow" class="external text" href="https://jlk.fjfi.cvut.cz/arch/manpages/man/refind-install.8">refind-install(8)</a></span> or read the comments in the install script for explanations of the various installation options.
</p><p>For many systems it should be sufficient to simply run:
</p>
<pre># refind-install
</pre>
<p>This will attempt to find and mount your <a href="/index.php/ESP" class="mw-redirect" title="ESP">ESP</a>, copy rEFInd files to <code><i>esp</i>/EFI/refind/</code>, and use <a href="/index.php/Efibootmgr" class="mw-redirect" title="Efibootmgr">efibootmgr</a> to make rEFInd the default EFI boot application.
</p><p>Alternatively you can install rEFInd to the default/fallback boot path <code><i>esp</i>/EFI/BOOT/bootx64.efi</code>. This is helpful for bootable USB flash drives or on systems that have issues with the NVRAM changes made by <i>efibootmgr</i>:
</p>
<pre># refind-install --usedefault <i>/dev/sdXY</i>
</pre>
<p>Where <code><i>/dev/sdXY</i></code> is of your EFI system partition.
</p>
<div class="archwiki-template-box archwiki-template-box-note"><strong>Note:</strong> By default <code>refind-install</code> installs only the driver for the file system on which kernel resides. Additional file systems need to be installed manually or you can install all drivers with the <code>--alldrivers</code> option. This is useful for bootable USB flash drives e.g.:
<pre># refind-install --usedefault <i>/dev/sdXY</i> --alldrivers
</pre>
</div>
<p>After installing rEFInd's files to the ESP, verify that rEFInd has created <code>refind_linux.conf</code> containing the required <a href="/index.php/Kernel_parameters" title="Kernel parameters">kernel parameters</a> (e.g. <code>root=</code>) in the same directory as your kernel. If it has not created this file, you will need to set up <a href="#Passing_kernel_parameters">#Passing kernel parameters</a> manually or you will most likely get a kernel panic on your next boot.
</p><p>By default, rEFInd will scan all of your drives (that it has drivers for) and add a boot entry for each EFI bootloader it finds, which should include your kernel (since Arch enables <a href="/index.php/EFISTUB" title="EFISTUB">EFISTUB</a> by default). So you may have a bootable system at this point.
</p>
<div class="archwiki-template-box archwiki-template-box-tip"><strong>Tip:</strong> It is always a good idea to edit the default configuration file <code><i>esp</i>/EFI/refind/refind.conf</code> to ensure that the default options work for you.</div>
<div class="archwiki-template-box archwiki-template-box-warning"><strong>Warning:</strong> When <code>refind-install</code> is run in chroot (e.g. in live system when installing Arch Linux) <code>/boot/refind_linux.conf</code> is populated with kernel options from the live system not the one on which it is installed. You will need to edit <code>/boot/refind_linux.conf</code> and adjust the kernel options manually. See <a href="#refind_linux.conf">#refind_linux.conf</a> for an example.</div>
<h4><span class="mw-headline" id="Secure_Boot">Secure Boot</span></h4>
<p>See <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/secureboot.html">Managing Secure Boot</a> for <a href="/index.php/Secure_Boot" title="Secure Boot">Secure Boot</a> support in rEFInd.
</p>
<h5><span class="mw-headline" id="Using_PreLoader">Using PreLoader</span></h5>
<p>See <a href="/index.php/Secure_Boot#Set_up_PreLoader" title="Secure Boot">Secure Boot#Set up PreLoader</a> to acquire signed <code>PreLoader.efi</code> and <code>HashTool.efi</code> binaries.
</p><p>Execute <code>refind-install</code> with the option <code>--preloader <i>/path/to/preloader</i></code>
</p>
<pre># refind-install --preloader /usr/share/preloader-signed/PreLoader.efi
</pre>
<p>Next time you boot with Secure Boot enabled, HashTool will launch and you will need to enroll the hash of rEFInd (<code>loader.efi</code>), rEFInd's drivers (e.g. <code>ext4_x64.efi</code>) and kernel (e.g. <code>vmlinuz-linux</code>).
</p><p>See <span class="plainlinks archwiki-template-man" title="$ man 8 refind-install"><a rel="nofollow" class="external text" href="https://jlk.fjfi.cvut.cz/arch/manpages/man/refind-install.8">refind-install(8)</a></span> for more information.
</p>
<div class="archwiki-template-box archwiki-template-box-tip"><strong>Tip:</strong> The signed <i>HashTool</i> is only capable of accessing the partition it was launched from. This means if your kernel is not on the ESP, you will not be able to enroll its hash from <i>HashTool</i>. You can workaround this by using <a href="#KeyTool">#KeyTool</a>, since it is capable of enrolling a hash in MokList and is not limited to one partition. Remember to enroll <i>KeyTool'</i>s hash before using it.</div>
<h5><span class="mw-headline" id="Using_shim">Using shim</span></h5>
<p><a href="/index.php/Install" class="mw-redirect" title="Install">Install</a> <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/shim-signed/">shim-signed</a></span><sup><small>AUR</small></sup>. Read <a href="/index.php/Secure_Boot#shim" title="Secure Boot">Secure Boot#shim</a>, but skip all file copying.
</p>
<h6><span class="mw-headline" id="Using_hashes">Using hashes</span></h6>
<p>To use only hashes with <i>shim</i>, execute <code>refind-install</code> with the option <code>--shim <i>/path/to/shim</i></code>
</p>
<pre># refind-install --shim /usr/share/shim-signed/shimx64.efi
</pre>
<p>Next time you boot with Secure Boot enabled, MokManager will launch and you will need to enroll the hash of rEFInd (<code>grubx64.efi</code>), rEFInd's drivers (e.g. <code>ext4_x64.efi</code>) and kernel (e.g. <code>vmlinuz-linux</code>).
</p>
<h6><span class="mw-headline" id="Using_Machine_Owner_Key">Using Machine Owner Key</span></h6>
<p>To sign rEFInd with a Machine Owner Key (MOK), install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=sbsigntools">sbsigntools</a></span>.
</p>
<div class="archwiki-template-box archwiki-template-box-tip"><strong>Tip:</strong> If you already have <a href="/index.php/Secure_Boot#shim_with_key" title="Secure Boot">created a MOK</a>, place the files in the directory <code>/etc/refind.d/keys</code> with the names <code>refind_local.key</code> (PEM format private key), <code>refind_local.crt</code> (PEM format certificate) and <code>refind_local.cer</code> (DER format certificate).</div>
<p>Execute <code>refind-install</code> with the options <code>--shim <i>/path/to/shim</i></code> and <code>--localkeys</code>:
</p>
<pre># refind-install --shim /usr/share/shim-signed/shimx64.efi --localkeys
</pre>
<p><i>refind-install</i> will create the keys for you and sign itself and its drivers. You will need to sign the kernel with the same key, e.g.:
</p>
<pre># sbsign --key /etc/refind.d/keys/refind_local.key --cert /etc/refind.d/keys/refind_local.crt --output /boot/vmlinuz-linux /boot/vmlinuz-linux
</pre>
<div class="archwiki-template-box archwiki-template-box-tip"><strong>Tip:</strong> The kernel signing can be automated with a <a href="/index.php/Pacman_hook" class="mw-redirect" title="Pacman hook">pacman hook</a>, e.g.:
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.d/hooks/999-sign_kernel_for_secureboot.hook</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Trigger]
Operation = Install
Operation = Upgrade
Type = Package
Target = linux

[Action]
Description = Signing kernel with Machine Owner Key for Secure Boot
When = PostTransaction
Exec = /usr/bin/sbsign --key /etc/refind.d/keys/refind_local.key --cert /etc/refind.d/keys/refind_local.crt --output /boot/vmlinuz-linux /boot/vmlinuz-linux
Depends = sbsigntools</pre>
</div>
<p>Once in MokManager add <code>refind_local.cer</code> to MoKList. <code>refind_local.cer</code> can be found inside a directory called <code>keys</code> in the rEFInd's installation directory, e.g. <code><i>esp</i>/EFI/refind/keys/refind_local.cer</code>.
</p><p>See <span class="plainlinks archwiki-template-man" title="$ man 8 refind-install"><a rel="nofollow" class="external text" href="https://jlk.fjfi.cvut.cz/arch/manpages/man/refind-install.8">refind-install(8)</a></span> for more information.
</p>
<h5><span class="mw-headline" id="Using_your_own_keys">Using your own keys</span></h5>
<p>Follow <a href="/index.php/Secure_Boot#Using_your_own_keys" title="Secure Boot">Secure Boot#Using your own keys</a> to create keys.
</p><p>Create directory <code>/etc/refind.d/keys</code> and place Signature Database (<b>db</b>) key and certificates in it. Name the files: <code>refind_local.key</code> (PEM format private key), <code>refind_local.crt</code> (PEM format certificate) and <code>refind_local.cer</code> (DER format certificate).
</p><p>When running install script add option <code>--localkeys</code>, e.g.:
</p>
<pre># refind-install --localkeys
</pre>
<p>rEFInd EFI binaries will be signed with the supplied key and certificate.
</p>
<h3><span class="mw-headline" id="Manual_installation">Manual installation</span></h3>
<div class="archwiki-template-box archwiki-template-box-tip"><strong>Tip:</strong> rEFInd can boot Linux in many ways. See <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/linux.html">The rEFInd Boot Manager: Methods of Booting Linux</a> for coverage of the various approaches.</div>
<p>If the <code>refind-install</code> script does not work for you, rEFInd can be set up manually.
</p><p>First, copy the executable to the ESP:
</p>
<pre># mkdir -p <i>esp</i>/EFI/refind
# cp /usr/share/refind/refind_x64.efi <i>esp</i>/EFI/refind/
</pre>
<p>If you want to install rEFInd to the default/fallback boot path replace <code><i>esp</i>/EFI/refind/</code> with <code><i>esp</i>/EFI/BOOT/</code> in the following instructions and copy rEFInd EFI executable to <code><i>esp</i>/EFI/BOOT/bootx64.efi</code>:
</p>
<pre># mkdir -p <i>esp</i>/EFI/BOOT
# cp /usr/share/refind/refind_x64.efi <i>esp</i>/EFI/BOOT/bootx64.efi
</pre>
<p>Then use <a href="/index.php/Efibootmgr" class="mw-redirect" title="Efibootmgr">efibootmgr</a> to create a boot entry in the UEFI NVRAM, where <code><i>/dev/sdX</i></code> and <code><i>Y</i></code> are the device and partition number of your EFI system partition. If you are installing rEFInd to the default/fallback boot path <code><i>esp</i>/EFI/BOOT/bootx64.efi</code>, you can skip this step.
</p>
<pre># efibootmgr --create --disk <i>/dev/sdX</i> --part <i>Y</i> --loader /EFI/refind/refind_x64.efi --label "rEFInd Boot Manager" --verbose
</pre>
<p>At this point, you should be able to reboot into rEFInd, but it will not be able to boot your kernel. If your kernel does not reside on your ESP, rEFInd can mount your partitions to find it - provided it has the right drivers.
</p><p>rEFInd automatically loads all drivers from the subdirectories <code>drivers</code> and <code>drivers_<i>arch</i></code> (e.g. <code>drivers_x64</code>) in its install directory.
</p>
<pre># mkdir <i>esp</i>/EFI/refind/drivers_x64
# cp /usr/share/refind/drivers_x64/<b>drivername</b>_x64.efi <i>esp</i>/EFI/refind/drivers_x64/
</pre>
<p>Now rEFInd should have a boot entry for your kernel, but it will not pass the correct kernel parameters. Set up <a href="#Passing_kernel_parameters">#Passing kernel parameters</a>. You should now be able to boot your kernel using rEFInd. If you are still unable to boot or if you want to tweak rEFInd's settings, many options can be changed with a configuration file:
</p>
<pre># cp /usr/share/refind/refind.conf-sample <i>esp</i>/EFI/refind/refind.conf
</pre>
<p>The sample configuration file is well commented and self-explanatory.
</p><p>Unless you have set <code>textonly</code> in the configuration file, you should copy rEFInd's icons to get rid of the ugly placeholders:
</p>
<pre># cp -r /usr/share/refind/icons <i>esp</i>/EFI/refind/
</pre>
<p>You can try out different fonts by copying them and changing the <code>font</code> setting in <code>refind.conf</code>:
</p>
<pre># cp -r /usr/share/refind/fonts <i>esp</i>/EFI/refind/
</pre>
<div class="archwiki-template-box archwiki-template-box-tip"><strong>Tip:</strong> Pressing <code>F10</code> in rEFInd will save a screenshot to the top level directory of the ESP.</div>
<h3><span class="mw-headline" id="Upgrading">Upgrading</span></h3>
<p>Pacman updates the rEFInd files in <code>/usr/share/refind/</code> and will not copy new files to the ESP for you. If <code>refind-install</code> worked for your original installation of rEFInd, you can rerun it to copy the updated files. The new configuration file will be copied as <code>refind.conf-sample</code> so that you can integrate changes into your existing configuration file using a diff tool. If your rEFInd required <a href="#Manual_installation">#Manual installation</a>, you will need to figure out which files to copy yourself.
</p>
<h4><span class="mw-headline" id="Pacman_hook">Pacman hook</span></h4>
<p>You can automate the update process using a <a href="/index.php/Pacman_hook" class="mw-redirect" title="Pacman hook">pacman hook</a>:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/etc/pacman.d/hooks/refind.hook</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">[Trigger]
Operation=Upgrade
Type=Package
Target=refind-efi

[Action]
Description = Updating rEFInd on ESP
When=PostTransaction
Exec=/usr/bin/refind-install</pre>
<p>Where the <code>Exec=</code> may need to be changed to the correct update command for your setup. If you did <a href="#Manual_installation">#Manual installation</a>, you could create your own update script to call with the hook.
</p>
<div class="archwiki-template-box archwiki-template-box-tip"><strong>Tip:</strong> If you setup rEFInd with <a href="#Secure_Boot">#Secure Boot</a>, you may want to additionally add the option <code>--yes</code> to the <code>refind-install</code> command. It will prevent the command from failing if it gets executed when Secure Boot is disabled. See <span class="plainlinks archwiki-template-man" title="$ man 8 refind-install"><a rel="nofollow" class="external text" href="https://jlk.fjfi.cvut.cz/arch/manpages/man/refind-install.8">refind-install(8)</a></span> for more information.</div>
<h2><span class="mw-headline" id="Configuration">Configuration</span></h2>
<p>The rEFInd configuration <code>refind.conf</code> is located in the same directory as the rEFInd EFI application (usually <code><i>esp</i>/EFI/refind</code> or <code><i>esp</i>/EFI/BOOT</code>). The default configuration file contains extensive comments explaining all its options, see <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/configfile.html">Configuring the Boot Manager</a> for more detailed explanations.
</p>
<h3><span class="mw-headline" id="Passing_kernel_parameters">Passing kernel parameters</span></h3>
<p>There are two methods for setting the <a href="/index.php/Kernel_parameters" title="Kernel parameters">kernel parameters</a> that rEFInd will pass to the kernel.
</p>
<h4><span class="mw-headline" id="For_kernels_automatically_detected_by_rEFInd">For kernels automatically detected by rEFInd</span></h4>
<p>For automatically detected kernels you can either specify the kernel parameters explicitly in <code>/boot/refind_linux.conf</code> or rely on rEFInd's ability to identify the root partition and kernel parameters. See <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/linux.html#easiest">Methods of Booting Linux: For Those With Foresight or Luck: The Easiest Method</a> for more information.
</p>
<div class="archwiki-template-box archwiki-template-box-tip"><strong>Tip:</strong> rEFInd will automatically choose the Arch Linux icon (<code>os_arch.png</code>) for the boot entry when <code>/etc/os-release</code> is on the same partition as the kernel. If your <code>/boot</code> is a separate partition see <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/configfile.html#icons">Configuring the Boot Manager: Setting OS Icons</a>.</div>
<p>For rEFInd to support the naming scheme of Arch Linux <a href="/index.php/Kernels" class="mw-redirect" title="Kernels">kernels</a> and thus allow matching them with their respective initramfs images, you must uncomment and edit <code>extra_kernel_version_strings</code> option in <code>refind.conf</code>. E.g.:
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"><i>esp</i>/EFI/refind/refind.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
extra_kernel_version_strings linux-hardened,linux-zen,linux-lts,linux
...
</pre>
<div class="archwiki-template-box archwiki-template-box-note"><strong>Note:</strong> 
<ul><li>rEFInd only supports detecting one initramfs image per kernel, meaning it will not detect fallback initramfs nor <a href="/index.php/Microcode" title="Microcode">microcode</a> images. They must be specified manually.</li>
<li>Without the above <code>extra_kernel_version_strings</code> line, the <code>%v</code> variable in <code>refind_linux.conf</code> will not work for Arch Linux <a href="/index.php/Kernels" class="mw-redirect" title="Kernels">kernels</a>.</li></ul>
</div>
<h5><span class="mw-headline" id="refind_linux.conf">refind_linux.conf</span></h5>
<p>If rEFInd automatically detects your kernel, you can place a <code>refind_linux.conf</code> file containing the kernel parameters in the same directory as your kernel. You can use <code>/usr/share/refind/refind_linux.conf-sample</code> as a starting point. The first uncommented line of <code>refind_linux.conf</code> will be the default parameters for the kernel. Subsequent lines will create entries in a submenu accessible using <code>+</code>, <code>F2</code>, or <code>Insert</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/boot/refind_linux.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">"Boot using default options"     "root=PARTUUID=<i>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</i> rw add_efi_memmap"
"Boot using fallback initramfs"  "root=PARTUUID=<i>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</i> rw add_efi_memmap initrd=/boot/initramfs-%v-fallback.img"
"Boot to terminal"               "root=PARTUUID=<i>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</i> rw add_efi_memmap systemd.unit=multi-user.target"</pre>
<p>Alternatively, try running:
</p>
<pre># mkrlconf
</pre>
<p>Which will attempt to find your kernel in <code>/boot</code> and automatically generate <code>refind_linux.conf</code>. The script will only set up the most basic kernel parameters, so be sure to check the file it created for correctness.
</p><p>If you do not specify an <code>initrd=</code> parameter, rEFInd will automatically add it by searching for common RAM disk filenames in the same directory as the kernel. If you need multiple <code>initrd=</code> parameters, you must specify them manually in <code>refind_linux.conf</code>. For example, a <a href="/index.php/Microcode" title="Microcode">microcode</a> passed before the initramfs:
</p>
<pre>"Boot using default options"     "root=PARTUUID=<i>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</i> rw add_efi_memmap initrd=/boot/intel-ucode.img initrd=/boot/amd-ucode.img initrd=/boot/initramfs-%v.img"
"Boot using fallback initramfs"  "root=PARTUUID=<i>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</i> rw add_efi_memmap initrd=/boot/intel-ucode.img initrd=/boot/amd-ucode.img initrd=/boot/initramfs-%v-fallback.img"
</pre>
<div class="archwiki-template-box archwiki-template-box-warning"><strong>Warning:</strong> <code>initrd</code> path is relative to the root of the file system on which the kernel resides. This could be <code>initrd=/boot/initramfs-%v.img</code> or, if ESP is mounted to <code>/boot</code>, <code>initrd=/initramfs-%v.img</code>.</div>
<div class="archwiki-template-box archwiki-template-box-note"><strong>Note:</strong> rEFInd replaces <code>%v</code> in <code>refind_linux.conf</code> with the kernel's version (by extracting if from the file name). For rEFInd to support Arch Linux kernels, the <code>extra_kernel_version_strings</code> in <code>esp/EFI/refind/refind.conf</code> must be edited as instructed in <a href="#For_kernels_automatically_detected_by_rEFInd">#For kernels automatically detected by rEFInd</a>.</div>
<h5><span class="mw-headline" id="Without_configuration">Without configuration</span></h5>
<div class="noprint archwiki-template-message">
<p><a href="/index.php/File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="/images/3/38/Tango-view-fullscreen.png" width="48" height="48" /></a><b>This article or section needs expansion.</b><a href="/index.php/File:Tango-view-fullscreen.png" class="image"><img alt="Tango-view-fullscreen.png" src="/images/3/38/Tango-view-fullscreen.png" width="48" height="48" /></a></p>
<div><b>Reason:</b> Add "Full auto detection" using Discoverable Partitions Specification and <code>/etc/fstab</code> reading. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:REFInd">Talk:REFInd#</a>)</div>
</div>
<p>If you merely install rEFInd onto the ESP and launch it without any further ado (say via UEFI shell or KeyTool) you still get a menu to boot from via autodetection, with no configuration required whatsoever.
</p><p>This is because rEFInd has a fallback mechanism that can:
</p>
<ul><li>Identify the root partition (for <code>root=</code> parameter ) via the <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Specifications/DiscoverablePartitionsSpec/">Discoverable Partitions Specification</a> or <code>/etc/fstab</code>.</li>
<li>Detect kernel options (<code>ro</code> or <code>rw</code>) from <a href="https://en.wikipedia.org/wiki/GUID_Partition_Table#Partition_entries_.28LBA_2-33.29" class="extiw" title="wikipedia:GUID Partition Table">GPT partition attributes</a> (using attribute <code>60</code> "read-only") or <code>/etc/fstab</code>.</li></ul>
<div class="archwiki-template-box archwiki-template-box-note"><strong>Note:</strong> rEFInd does not support escape codes (e.g. for <a href="/index.php/Fstab#Filepath_spaces" title="Fstab">spaces</a>) in <code>/etc/fstab</code>.</div>
<h4><span class="mw-headline" id="Manual_boot_stanzas">Manual boot stanzas</span></h4>
<p>If your kernel is not autodetected, or if you simply want more control over the options for a menu entry, you can manually create boot entries using stanzas in <code>refind.conf</code>. Ensure that <code>scanfor</code> includes <code>manual</code> or these entries will not appear in rEFInd's menu. Kernel parameters are set with the <code>options</code> keyword. rEFInd will append the <code>initrd=</code> parameter using the file specified by the <code>initrd</code> keyword in the stanza. If you need additional initrds (e.g. for <a href="/index.php/Microcode" title="Microcode">Microcode</a>), you can specify them in <code>options</code> (and the one specified by the <code>initrd</code> keyword will be added to the end).
</p><p>Manual boot stanzas are explained in <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/configfile.html#stanzas">Creating Manual Boot Stanzas</a>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"><i>esp</i>/EFI/refind/refind.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...

menuentry "Arch Linux" {
	icon     /EFI/refind/icons/os_arch.png
	volume   "Arch Linux"
	loader   /boot/vmlinuz-linux
	initrd   /boot/initramfs-linux.img
	options  "root=PARTUUID=<i>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</i> rw add_efi_memmap"
	submenuentry "Boot using fallback initramfs" {
		initrd /boot/initramfs-linux-fallback.img
	}
	submenuentry "Boot to terminal" {
		add_options "systemd.unit=multi-user.target"
	}
}</pre>
<p>It is likely that you will need to change <code>volume</code> to match either a filesystem's LABEL, a PARTLABEL, or a PARTUUID of the partition where the kernel image resides. See <a href="/index.php/Persistent_block_device_naming#by-label" title="Persistent block device naming">Persistent block device naming#by-label</a> for examples of assigning a volume label. If <code>volume</code> is not specified it defaults to volume from which rEFInd was launched (typically EFI system partition).
</p>
<div class="archwiki-template-box archwiki-template-box-warning"><strong>Warning:</strong> <code>loader</code> and <code>initrd</code> paths are relative to the root of <code>volume</code>.</div>
<h2><span class="mw-headline" id="Installation_alongside_an_existing_UEFI_Windows_installation">Installation alongside an existing UEFI Windows installation</span></h2>
<div class="archwiki-template-box archwiki-template-box-note"><strong>Note:</strong> The usual caveats of <a href="/index.php/Dual_boot_with_Windows" title="Dual boot with Windows">Dual boot with Windows</a> apply.</div>
<p>rEFInd is compatible with the EFI system partition created by a UEFI Windows installation, so there is no need to create or format another FAT32 partition when installing Arch alongside Windows. Simply mount the existing ESP and install rEFInd as usual. By default, rEFInd's autodetection feature should recognize any existing Windows/recovery bootloaders.
</p>
<div class="archwiki-template-box archwiki-template-box-note"><strong>Note:</strong> In some cases, Windows behaves differently (low resolution boot screen, OEM logo replaced by Windows logo, black screen after boot screen, artifacting). If you face such issues, try setting <code>use_graphics_for +,windows</code> in <code><i>esp</i>/EFI/refind/refind.conf</code> or adding <code>graphics on</code> to the Windows boot stanza.</div>
<h2><span class="mw-headline" id="Tools">Tools</span></h2>
<div class="noprint archwiki-template-message">
<p><a href="/index.php/File:Tango-go-next.png" class="image"><img alt="Tango-go-next.png" src="/images/f/f0/Tango-go-next.png" width="48" height="48" /></a><b>This article or section is a candidate for moving to <a href="/index.php/Unified_Extensible_Firmware_Interface" title="Unified Extensible Firmware Interface">Unified Extensible Firmware Interface</a>.</b><a href="/index.php/File:Tango-go-next.png" class="image"><img alt="Tango-go-next.png" src="/images/f/f0/Tango-go-next.png" width="48" height="48" /></a></p>
<div><b>Notes:</b> Although rEFInd has a special interface for these common tools, they are not a feature of rEFInd. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:REFInd">Talk:REFInd#</a>)</div>
</div>
<p>rEFInd supports running various <a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/installing.html#addons">3rd-party tools</a>. Tools need to be installed separately. Edit <code>showtools</code> in <code>refind.conf</code> to choose which ones to show.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"><i>esp</i>/EFI/refind/refind.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
showtools <a href="#UEFI_shell">shell</a>, <a href="#Memtest86">memtest</a>, <a href="#Key_management_tools">mok_tool</a>, <a href="#GPT_fdisk_(gdisk)">gdisk</a>, <a href="#iPXE">netboot</a>, <a href="#fwupdate">fwupdate</a> ...
...
</pre>
<h3><span class="mw-headline" id="UEFI_shell">UEFI shell</span></h3>
<p>See <a href="/index.php/Unified_Extensible_Firmware_Interface#UEFI_Shell" title="Unified Extensible Firmware Interface">Unified Extensible Firmware Interface#UEFI Shell</a>.
</p><p>Copy <code>shellx64.efi</code> to the root of the <a href="/index.php/EFI_system_partition" title="EFI system partition">EFI system partition</a>.
</p>
<h3><span class="mw-headline" id="Memtest86">Memtest86</span></h3>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/memtest86-efi/">memtest86-efi</a></span><sup><small>AUR</small></sup> and copy it to <code><i>esp</i>/EFI/tools/</code>.
</p>
<pre># cp /usr/share/memtest86-efi/bootx64.efi <i>esp</i>/EFI/tools/memtest86.efi
</pre>
<h3><span class="mw-headline" id="Key_management_tools">Key management tools</span></h3>
<p>rEFInd can detect Secure Boot key management tools if they are placed in rEFInd's directory on ESP, <code><i>esp</i>/</code> or <code><i>esp</i>/EFI/tools/</code>.
</p>
<h4><span class="mw-headline" id="HashTool">HashTool</span></h4>
<p>Follow <a href="#Using_PreLoader">#Using PreLoader</a> and <code>HashTool.efi</code> will be placed in rEFInd's directory.
</p>
<h4><span class="mw-headline" id="MokManager">MokManager</span></h4>
<p>Follow <a href="#Using_shim">#Using shim</a> and MokManager will be placed in rEFInd's directory.
</p>
<h4><span class="mw-headline" id="KeyTool">KeyTool</span></h4>
<p>Install <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=efitools">efitools</a></span>.
</p><p>Place KeyTool EFI binary in <code><i>esp</i>/</code> or <code><i>esp</i>/EFI/tools/</code> with the name <code>KeyTool.efi</code> or <code>KeyTool-signed.efi</code>.
</p><p>See <a href="/index.php/Secure_Boot#Using_KeyTool" title="Secure Boot">Secure Boot#Using KeyTool</a> for instructions on signing <code>KeyTool.efi</code>.
</p>
<h3><span id="GPT_fdisk_.28gdisk.29"></span><span class="mw-headline" id="GPT_fdisk_(gdisk)">GPT fdisk (gdisk)</span></h3>
<p>Download the <a href="/index.php/Gdisk#gdisk_EFI_application" title="Gdisk">gdisk EFI application</a> and copy <code>gdisk_x64.efi</code> to <code><i>esp</i>/EFI/tools/</code>.
</p>
<h3><span class="mw-headline" id="iPXE">iPXE</span></h3>
<div class="noprint archwiki-template-message">
<p><a href="/index.php/File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="/images/2/28/Tango-view-refresh-red.png" width="48" height="48" /></a><b>This article or section is out of date.</b><a href="/index.php/File:Tango-view-refresh-red.png" class="image"><img alt="Tango-view-refresh-red.png" src="/images/2/28/Tango-view-refresh-red.png" width="48" height="48" /></a></p>
<div><b>Reason:</b> iPXE is not packaged in <span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=refind-efi">refind-efi</a></span> anymore. (Discuss in <a rel="nofollow" class="external text" href="https://wiki.archlinux.org/index.php/Talk:REFInd">Talk:REFInd#</a>)</div>
</div>
<div class="archwiki-template-box archwiki-template-box-note"><strong>Note:</strong> PXE support in rEFInd is <b>experimental</b>.</div>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://www.archlinux.org/packages/?name=refind-efi">refind-efi</a></span> contains the iPXE UEFI binaries, you just need to copy them to <code><i>esp</i>/EFI/tools/</code>.
</p>
<pre># cp /usr/share/refind/tools_x64/ipxe_discovery_x64.efi <i>esp</i>/EFI/tools/ipxe_discovery.efi
# cp /usr/share/refind/tools_x64/ipxe_x64.efi <i>esp</i>/EFI/tools/ipxe.efi
</pre>
<h3><span class="mw-headline" id="fwupdate">fwupdate</span></h3>
<p>Install and setup <a href="/index.php/Fwupd" title="Fwupd">fwupd</a>.
</p><p>Copy the <code>fwupx64.efi</code> binary and firmware files to <code><i>esp</i>/EFI/tools/</code>:
</p>
<pre># cp -r /usr/lib/fwupdate/EFI/arch/* <i>esp</i>/EFI/tools/
</pre>
<h2><span class="mw-headline" id="Tips_and_tricks">Tips and tricks</span></h2>
<h3><span class="mw-headline" id="Using_drivers_in_UEFI_shell">Using drivers in UEFI shell</span></h3>
<p>To use rEFInd's drivers in UEFI shell load them using command <code>load</code> and refresh mapped drives with <code>map -r</code>.
</p>
<pre>Shell&gt; load FS0:\EFI\refind\drivers\ext4_x64.efi
Shell&gt; map -r
</pre>
<p>Now you can access your file system from UEFI shell.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3><span class="mw-headline" id="Btrfs_subvolume_support">Btrfs subvolume support</span></h3>
<h4><span class="mw-headline" id="Auto_detection">Auto detection</span></h4>
<p>To allow kernel auto detection on a Btrfs subvolume uncomment and edit <code>also_scan_dirs</code> in <code>refind.conf</code>.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"><i>esp</i>/EFI/refind/refind.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
also_scan_dirs +,<i>subvolume</i>/boot
...
</pre>
<p>Next add <code>subvol=<i>subvolume</i></code> to <code>rootflags</code> in <code>refind_linux.conf</code> and then prepend <code><i>subvolume</i></code> to the initrd path.
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;">/boot/refind_linux.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">"Boot using standard options"  "root=PARTUUID=<i>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</i> rw <b>rootflags=subvol=<i>subvolume</i></b> initrd=<i><b>subvolume</b></i>/boot/initramfs-%v.img"</pre>
<h4><span class="mw-headline" id="Manual_boot_stanza">Manual boot stanza</span></h4>
<p>If booting a <a href="/index.php/Btrfs" title="Btrfs">btrfs</a> subvolume as root, amend the <code>options</code> line with <code>rootflags=subvol=<i>root_subvolume</i></code>. In the example below, root has been mounted as a btrfs subvolume called 'ROOT' (e.g. <code>mount -o subvol=ROOT /dev/sdxY /mnt</code>):
</p>
<pre style="margin-bottom: 0; border-bottom:none; padding-bottom:0.8em;"><i>esp</i>/EFI/refind/refind.conf</pre>
<pre style="margin-top: 0; border-top-style:dashed; padding-top: 0.8em;">...
menuentry "Arch Linux" {
        icon     /EFI/refind/icons/os_arch.png
        volume   "[bootdevice]"
        loader   /boot/vmlinuz-linux
        initrd   /boot/initramfs-linux.img
        options  "root=PARTUUID=<i>XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX</i> rw <b>rootflags=subvol=ROOT</b>"
...
}</pre>
<p>A failure to do so will otherwise result in the following error message: <code>ERROR: Root device mounted successfully, but /sbin/init does not exist.</code>
</p>
<h3><span class="mw-headline" id="Apple_Macs">Apple Macs</span></h3>
<p><span class="plainlinks archwiki-template-pkg"><a rel="nofollow" class="external text" href="https://aur.archlinux.org/packages/mactel-boot/">mactel-boot</a></span><sup><small>AUR</small></sup> is an experimental <i>bless</i> utility for Linux. If that does not work, use <i>bless</i> from within OSX to set rEFInd as the default boot entry:
</p>
<pre># bless --setBoot --folder <i>esp</i>/EFI/refind --file <i>esp</i>/EFI/refind/refind_x64.efi
</pre>
<h3><span class="mw-headline" id="VirtualBox">VirtualBox</span></h3>
<p>Currently, VirtualBox will only boot the default <code><i>esp</i>/EFI/BOOT/bootx64.efi</code> path, so <code>refind-install</code> needs to be used with at least the <code>--usedefault</code> option. See <a href="/index.php/VirtualBox#Installation_in_EFI_mode" title="VirtualBox">VirtualBox#Installation in EFI mode</a> for more information.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://www.rodsbooks.com/refind/">The rEFInd Boot Manager</a> by Roderick W. Smith.</li>
<li><a href="https://en.wikipedia.org/wiki/rEFInd" class="extiw" title="wikipedia:rEFInd">Wikipedia:rEFInd</a></li>
<li><code>/usr/share/refind/docs/README.txt</code></li>
<li><a rel="nofollow" class="external text" href="https://sourceforge.net/p/refind/discussion/">rEFInd discussion forum on Sourceforge</a></li></ul>

<!-- 
NewPP limit report
Cached time: 20181222042806
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.106 seconds
Real time usage: 0.111 seconds
Preprocessor visited node count: 1664/1000000
Preprocessor generated node count: 4790/1000000
Post‐expand include size: 20119/2097152 bytes
Template argument size: 11364/2097152 bytes
Highest expansion depth: 6/40
Expensive parser function count: 0/100
Unstrip recursion depth: 0/20
Unstrip post‐expand size: 0/5000000 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   39.120      1 -total
 27.33%   10.690    148 Template:Ic
  9.19%    3.595      8 Template:Tip
  8.14%    3.184      9 Template:Note
  5.45%    2.131      1 Template:Expansion
  5.41%    2.116      3 Template:META_Message
  5.13%    2.008      4 Template:Man
  5.00%    1.956      9 Template:Hc
  4.70%    1.838      3 Template:Warning
  3.95%    1.547      1 Template:Out_of_date
-->
</div>
<!-- Saved in parser cache with key archwiki:pcache:idhash:17729-0!canonical and timestamp 20181222042806 and revision id 558889
 -->
</div>					<div class="printfooter">
						Retrieved from "<a dir="ltr" href="https://wiki.archlinux.org/index.php?title=REFInd&amp;oldid=558889">https://wiki.archlinux.org/index.php?title=REFInd&amp;oldid=558889</a>"					</div>
				<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="/index.php/Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="/index.php/Category:Boot_loaders" title="Category:Boot loaders">Boot loaders</a></li></ul></div><div id="mw-hidden-catlinks" class="mw-hidden-catlinks mw-hidden-cats-hidden">Hidden categories: <ul><li><a href="/index.php/Category:Pages_or_sections_flagged_with_Template:Expansion" title="Category:Pages or sections flagged with Template:Expansion">Pages or sections flagged with Template:Expansion</a></li><li><a href="/index.php/Category:Pages_or_sections_flagged_with_Template:Move" title="Category:Pages or sections flagged with Template:Move">Pages or sections flagged with Template:Move</a></li><li><a href="/index.php/Category:Pages_or_sections_flagged_with_Template:Out_of_date" title="Category:Pages or sections flagged with Template:Out of date">Pages or sections flagged with Template:Out of date</a></li></ul></div></div>				<div class="visualClear"></div>
							</div>
		</div>
		<div id="mw-navigation">
			<h2>Navigation menu</h2>
			<div id="mw-head">
									<div id="p-personal" role="navigation" class="" aria-labelledby="p-personal-label">
						<h3 id="p-personal-label">Personal tools</h3>
						<ul>
							<li id="pt-createaccount"><a href="/index.php?title=Special:CreateAccount&amp;returnto=REFInd" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="/index.php?title=Special:UserLogin&amp;returnto=REFInd" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>						</ul>
					</div>
									<div id="left-navigation">
										<div id="p-namespaces" role="navigation" class="vectorTabs" aria-labelledby="p-namespaces-label">
						<h3 id="p-namespaces-label">Namespaces</h3>
						<ul>
							<li id="ca-nstab-main" class="selected"><span><a href="/index.php/REFInd" title="View the content page [c]" accesskey="c">Page</a></span></li><li id="ca-talk"><span><a href="/index.php/Talk:REFInd" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></span></li>						</ul>
					</div>
										<div id="p-variants" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-variants-label">
												<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-variants-label" />
						<h3 id="p-variants-label">
							<span>Variants</span>
						</h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
									</div>
				<div id="right-navigation">
										<div id="p-views" role="navigation" class="vectorTabs" aria-labelledby="p-views-label">
						<h3 id="p-views-label">Views</h3>
						<ul>
							<li id="ca-view" class="collapsible selected"><span><a href="/index.php/REFInd">Read</a></span></li><li id="ca-viewsource" class="collapsible"><span><a href="/index.php?title=REFInd&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></span></li><li id="ca-history" class="collapsible"><span><a href="/index.php?title=REFInd&amp;action=history" title="Past revisions of this page [h]" accesskey="h">View history</a></span></li>						</ul>
					</div>
										<div id="p-cactions" role="navigation" class="vectorMenu emptyPortlet" aria-labelledby="p-cactions-label">
						<input type="checkbox" class="vectorMenuCheckbox" aria-labelledby="p-cactions-label" />
						<h3 id="p-cactions-label"><span>More</span></h3>
						<div class="menu">
							<ul>
															</ul>
						</div>
					</div>
										<div id="p-search" role="search">
						<h3>
							<label for="searchInput">Search</label>
						</h3>
						<form action="/index.php" id="searchform">
							<div id="simpleSearch">
								<input type="search" name="search" placeholder="Search ArchWiki" title="Search ArchWiki [f]" accesskey="f" id="searchInput"/><input type="hidden" value="Special:Search" name="title"/><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton mw-fallbackSearchButton"/><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchButton" class="searchButton"/>							</div>
						</form>
					</div>
									</div>
			</div>
			<div id="mw-panel">
				<div id="p-logo" role="banner"><a class="mw-wiki-logo" href="/index.php/Main_page"  title="Visit the main page"></a></div>
						<div class="portal" role="navigation" id="p-navigation" aria-labelledby="p-navigation-label">
			<h3 id="p-navigation-label">Navigation</h3>
			<div class="body">
								<ul>
					<li id="n-mainpage-description"><a href="/index.php/Main_page" title="Visit the main page [z]" accesskey="z">Main page</a></li><li id="n-Table-of-contents"><a href="/index.php/Table_of_contents">Table of contents</a></li><li id="n-portal"><a href="/index.php/Getting_involved" title="Various ways Archers can contribute to the community">Getting involved</a></li><li id="n-currentevents"><a href="/index.php/ArchWiki:News" title="The latest lowdown on the wiki">Wiki news</a></li><li id="n-randompage"><a href="/index.php/Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-Interaction" aria-labelledby="p-Interaction-label">
			<h3 id="p-Interaction-label">Interaction</h3>
			<div class="body">
								<ul>
					<li id="n-help"><a href="/index.php/Category:Help" title="Wiki navigation, reading, and editing help">Help</a></li><li id="n-Contributing"><a href="/index.php/ArchWiki:Contributing">Contributing</a></li><li id="n-recentchanges"><a href="/index.php/Special:RecentChanges" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-Recent-talks"><a href="https://wiki.archlinux.org/index.php/Special:RecentChanges?namespace=0&amp;invert=1" rel="nofollow">Recent talks</a></li><li id="n-newpages"><a href="/index.php/Special:NewPages">New pages</a></li><li id="n-Statistics"><a href="/index.php/ArchWiki:Statistics">Statistics</a></li><li id="n-Requests"><a href="/index.php/ArchWiki:Requests">Requests</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-tb" aria-labelledby="p-tb-label">
			<h3 id="p-tb-label">Tools</h3>
			<div class="body">
								<ul>
					<li id="t-whatlinkshere"><a href="/index.php/Special:WhatLinksHere/REFInd" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="/index.php/Special:RecentChangesLinked/REFInd" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="/index.php/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="/index.php?title=REFInd&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="/index.php?title=REFInd&amp;oldid=558889" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="/index.php?title=REFInd&amp;action=info" title="More information about this page">Page information</a></li>				</ul>
							</div>
		</div>
			<div class="portal" role="navigation" id="p-lang" aria-labelledby="p-lang-label">
			<h3 id="p-lang-label">In other languages</h3>
			<div class="body">
								<ul>
					<li class="interlanguage-link interwiki-ja"><a href="https://wiki.archlinux.jp/index.php/REFInd" title="REFInd – 日本語" lang="ja" hreflang="ja" class="interlanguage-link-target">日本語</a></li><li class="interlanguage-link interwiki-ru"><a href="https://wiki.archlinux.org/index.php/REFInd_(%D0%A0%D1%83%D1%81%D1%81%D0%BA%D0%B8%D0%B9)" title="REFInd – русский" lang="ru" hreflang="ru" class="interlanguage-link-target">Русский</a></li><li class="interlanguage-link interwiki-zh-hans"><a href="https://wiki.archlinux.org/index.php/REFInd_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)" title="REFInd – 中文（简体）‎" lang="zh-Hans" hreflang="zh-Hans" class="interlanguage-link-target">中文（简体）‎</a></li>				</ul>
							</div>
		</div>
				</div>
		</div>
				<div id="footer" role="contentinfo">
						<ul id="footer-info">
								<li id="footer-info-lastmod"> This page was last edited on 11 December 2018, at 13:14.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.3 or later</a> unless otherwise noted.</li>
							</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="/index.php/ArchWiki:Privacy_policy" class="mw-redirect" title="ArchWiki:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="/index.php/ArchWiki:About" title="ArchWiki:About">About ArchWiki</a></li>
								<li id="footer-places-disclaimer"><a href="/index.php/ArchWiki:General_disclaimer" title="ArchWiki:General disclaimer">Disclaimers</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
											</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		<script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"limitreport":{"cputime":"0.106","walltime":"0.111","ppvisitednodes":{"value":1664,"limit":1000000},"ppgeneratednodes":{"value":4790,"limit":1000000},"postexpandincludesize":{"value":20119,"limit":2097152},"templateargumentsize":{"value":11364,"limit":2097152},"expansiondepth":{"value":6,"limit":40},"expensivefunctioncount":{"value":0,"limit":100},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":0,"limit":5000000},"timingprofile":["100.00%   39.120      1 -total"," 27.33%   10.690    148 Template:Ic","  9.19%    3.595      8 Template:Tip","  8.14%    3.184      9 Template:Note","  5.45%    2.131      1 Template:Expansion","  5.41%    2.116      3 Template:META_Message","  5.13%    2.008      4 Template:Man","  5.00%    1.956      9 Template:Hc","  4.70%    1.838      3 Template:Warning","  3.95%    1.547      1 Template:Out_of_date"]},"cachereport":{"timestamp":"20181222042806","ttl":86400,"transientcontent":false}}});});</script><script>(window.RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgBackendResponseTime":66});});</script>
	</body>
<!-- Cached/compressed 20181223041554 -->
</html>
