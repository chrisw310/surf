if (self.CavalryLogger) { CavalryLogger.start_js(["ChyMj"]); }

__d("PagesTimelineMapEventsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function a(){this.$1={}}a.prototype.log=function(){b("GeneratedLoggerUtils").log("logger:PagesTimelineMapEventsLoggerConfig",this.$1,b("Banzai").BASIC)};a.prototype.logVital=function(){b("GeneratedLoggerUtils").log("logger:PagesTimelineMapEventsLoggerConfig",this.$1,b("Banzai").VITAL)};a.prototype.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:PagesTimelineMapEventsLoggerConfig",this.$1,{signal:!0})};a.prototype.clear=function(){this.$1={};return this};a.prototype.getData=function(){return babelHelpers["extends"]({},this.$1)};a.prototype.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};a.prototype.setEvent=function(a){this.$1.event=a;return this};a.prototype.setProfileID=function(a){this.$1.profile_id=a;return this};c={event:!0,profile_id:!0};e.exports=a}),null);
__d("legacy:AggregatedMap",["AggregatedMap","AggregatedMapCalloutOrientation"],(function(a,b,c,d,e,f){a.AggregatedMap=b("AggregatedMap"),a.AggregatedMapCalloutOrientation=b("AggregatedMapCalloutOrientation")}),3);
__d("AggregatedMapRedPin",["AggregatedMapPin","AggregatedMapRedPinSprite"],(function(a,b,c,d,e,f){var g;c=babelHelpers.inherits(a,b("AggregatedMapPin"));g=c&&c.prototype;function a(a,c,d,e,f){"use strict";e=b("AggregatedMapRedPinSprite").dot(e);g.constructor.call(this,a,e,c,d,f)}e.exports=a}),null);
__d("PagesTimelineMapEvents",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({CHANGE_VIEW:"change_view",CLICK_BUBBLE:"click_bubble",CLICK_MAP:"click_map",CLICK_PIN:"click_pin",CLICK_RESULT:"click_result",NO_SEARCH_RESULTS:"no_search_results",READY:"ready",SUBMIT_SEARCH:"submit_search",CLICK_REFRESH:"click_refresh",MOVE_MAP:"move_map"})}),null);
__d("XPagesTimelineMapListViewController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/pages/map/list_view/",{list_data:{type:"IntVector",required:!0},header_type:{type:"Int",required:!0}})}),null);
__d("PagesTimelineMapController",["fbt","AggregatedMap","Arbiter","AsyncRequest","CSS","DOM","PagesTimelineMapEvents","PagesTimelineMapEventsTypedLogger","Scroll","Toggler","XPagesTimelineMapListViewController","$","debounce","ge"],(function(a,b,c,d,e,f,g){__p&&__p();function h(){this._lastViewQueried=null,this._pinsFromLatLong=[],this._alreadyHasPinsForNextViewChange=!0,this._listeners=[],this._calloutCache=[],this._lastRequestedCallout=null,this._requestSeq=0,this._resultPins=null,this._temporaryActiveLocationID=null,this._activeResultID=null,this._isPostSearch=!1}Object.assign(h,{ARBITER_EVENT_SET_RESULTS:"PageLocationsMap/setResults",ARBITER_EVENT_NO_SEARCH_RESULTS:"PageLocationsMap/noSearchResults",ARBITER_EVENT_MOVE_MAP:"PageLocationsMap/moveTo",ARBITER_EVENT_RESULT_CLICK:"PageLocationsMap/resultClick",ARBITER_EVENT_CLEAR_ACTIVE:"PageLocationsMap/clearActiveResult",ARBITER_EVENT_REFRESH_CLICK:"PageLocationsMap/refreshClick",ARBITER_EVENT_ENABLE_POST_SEARCH:"PageLocationsMap/enablePostSearch",ALWAYS_SHOW_REQUEST_SEQ:-1,RESULT_CLICK_ZOOM_LEVEL:14,LIST_VIEW_NO_HEADER:0,LIST_VIEW_SAME_LOCATION:1,CALLOUT_WIDTH:300,CALLOUT_MAX_HEIGHT:100,_isSameView:function(a,b){return!a||!b?!1:a.center.latitude==b.center.latitude&&a.center.longitude==b.center.longitude&&a.zoom==b.zoom}});Object.assign(h.prototype,{init:function(a,c,d,e,f,g,i,j,k){this.map=a,this.overlayMessage=c,this.listViewer=d,this.refreshLink=e,this.profileID=f,this.instanceID=g,this._setIsExhaustive(i),j&&(this._resultPins=k,this._showListViewer(k,h.LIST_VIEW_NO_HEADER)),this._subscribe("AggregatedMap/"+b("AggregatedMap").Events.ready,function(){this._log(b("PagesTimelineMapEvents").READY),this._setPins(k)}.bind(this)),this._subscribe("AggregatedMap/"+b("AggregatedMap").Events.viewChange,b("debounce")(this._onViewChange.bind(this),200)),this._subscribe("AggregatedMap/"+b("AggregatedMap").Events.bubbleClick,this._onBubbleClick.bind(this)),this._subscribe("AggregatedMap/"+b("AggregatedMap").Events.pinClick,this._onPinClick.bind(this)),this._subscribe("AggregatedMap/"+b("AggregatedMap").Events.mapClick,this._onMapClick.bind(this)),this._subscribe("AggregatedMap/"+b("AggregatedMap").Events.onSearchSubmit,this._onSearchSubmit.bind(this)),this._subscribe(h.ARBITER_EVENT_SET_RESULTS,this._setLocations.bind(this)),this._subscribe(h.ARBITER_EVENT_NO_SEARCH_RESULTS,this._onNoSearchResults.bind(this)),this._subscribe(h.ARBITER_EVENT_MOVE_MAP,this._onMoveMapTo.bind(this)),this._subscribe(h.ARBITER_EVENT_RESULT_CLICK,this._onResultClick.bind(this)),this._subscribe(h.ARBITER_EVENT_CLEAR_ACTIVE,this._clearActiveResult.bind(this)),this._subscribe(h.ARBITER_EVENT_REFRESH_CLICK,this._onRefreshClick.bind(this)),this._subscribe(h.ARBITER_EVENT_ENABLE_POST_SEARCH,this._enablePostSearch.bind(this))},_log:function(a){new(b("PagesTimelineMapEventsTypedLogger"))().setEvent(a).setProfileID(this.profileID).log()},_showLocationCallout:function(a){for(var b=0;b<this.map.visiblePins.length;b++)if(this.map.visiblePins[b].profileID==a){this._showCallout(this.map.visiblePins[b]);break}},_showCallout:function(a){var b=this._calloutCache[a[0].profileID];if(!b){var c=h.CALLOUT_WIDTH;c=this.map.throbber(c);this._lastRequestedCallout=a[0].profileID;this._fetchCallout(a)}else c=b;this.map.openCallout(a[0],c,this.map.smartPanningStrategy(h.CALLOUT_WIDTH,h.CALLOUT_MAX_HEIGHT))},_fetchCallout:function(a){var c=a.map(function(a){return a.profileID});new(b("AsyncRequest"))().setURI("/ajax/pages/map/callout.php").setData({profile_ids:c}).setHandler(function(b){this._onFetchCalloutResponse(a,b)}.bind(this)).send()},_onFetchCalloutResponse:function(a,b){this._calloutCache[a[0].profileID]=b.payload,this._lastRequestedCallout===a[0].profileID&&this._showCallout(a)},_setIsExhaustive:function(a){this.isExhaustive=a,!a?(b("DOM").setContent(this.overlayMessage,g._("There were too many results to display, so only the top 200 are being shown. Zoom in to see more results in this area.")),b("CSS").show(this.overlayMessage)):b("CSS").hide(this.overlayMessage)},_clearActiveResult:function(a){this._activeResultID=null,this.map.hideCallout()},_hideActiveList:function(){var a=b("ge")("locations_map_result_"+this._activeResultID);a&&b("Toggler").hide(a);this._activeResultID=null;this._hideRefreshLink()},_onBubbleClick:function(a,c){this._log(b("PagesTimelineMapEvents").CLICK_BUBBLE),this.map.zoomInto(c.pins)},_onPinClick:function(a,c){__p&&__p();this._log(b("PagesTimelineMapEvents").CLICK_PIN);a=[c.anchor.latitude,c.anchor.longitude];a=this._pinsFromLatLong[a];if(this.map.getCallout().getAnchor()===c){this.map.hideCallout();this._isPostSearch||this._hideActiveList();return}var d=b("ge")("locations_map_result_"+c.profileID);if(a.length>1)this._showListViewer(a,h.LIST_VIEW_SAME_LOCATION),this._resultPins=a;else if(d){b("Toggler").show(d);d=d.offsetTop;var e=b("$")("listViewContent");b("Scroll").setTop(e,d)}else this._showListViewer([c],h.LIST_VIEW_NO_HEADER),this._resultPins=[c];this._showCallout(a);this._activeResultID=c.profileID},_onMapClick:function(a){this._log(b("PagesTimelineMapEvents").CLICK_MAP),this.map.hideCallout(),this._hideActiveList()},_onResultClick:function(a,c){__p&&__p();this._log(b("PagesTimelineMapEvents").CLICK_RESULT);a=null;for(var d=0;d<this._resultPins.length;d++)if(this._resultPins[d].profileID==c){a=this._resultPins[d];break}d={center:{latitude:a.anchor.latitude,longitude:a.anchor.longitude},zoom:Math.max(h.RESULT_CLICK_ZOOM_LEVEL,this.map.lastZoom)};this.map.setView(d);this._temporaryActiveLocationID=c;this._setLocations.bind(d);this._activeResultID=c},_onRefreshClick:function(a){this._log(b("PagesTimelineMapEvents").CLICK_REFRESH);this._clearActiveResult();this._showListViewer(this.map.visiblePins,h.LIST_VIEW_NO_HEADER);this._hideRefreshLink();this._isPostSearch=!1;a=b("$")("location_search_field");a.value=null},_onViewChange:function(a,c){__p&&__p();this._log(b("PagesTimelineMapEvents").CHANGE_VIEW);c.bounds=this.map.getBounds();if(this._alreadyHasPinsForNextViewChange){this._alreadyHasPinsForNextViewChange=!1;this._lastViewQueried=c;return}if(h._isSameView(this._lastViewQueried,c))return;(!this.isExhaustive||!this._lastViewQueried.bounds.containsGeoRectangle(c.bounds))&&(this._showOverlayMessage(g._("Loading...")),new(b("AsyncRequest"))().setURI("/ajax/pages/map/locations.php").setData({profile_id:this.profileID,bounds:c.bounds.toArray(),seq:++this._requestSeq}).send(),this._lastViewQueried=c)},_onMoveMapTo:function(a,c){this._log(b("PagesTimelineMapEvents").MOVE_MAP),c.sentPinData&&(this._alreadyHasPinsForNextViewChange=!0),this.map.setView(c.view)},_onSearchSubmit:function(a){this._log(b("PagesTimelineMapEvents").SUBMIT_SEARCH),this._showOverlayMessage(g._("Loading...")),this._clearActiveResult(),this._hideRefreshLink()},_enablePostSearch:function(a){this._isPostSearch=!0},_onNoSearchResults:function(a){this._log(b("PagesTimelineMapEvents").NO_SEARCH_RESULTS),this._showOverlayMessage(g._("No results were found for your search."))},_setPins:function(a){this._pinsFromLatLong=[];for(var b=0;b<a.length;b++){var c=[a[b].anchor.latitude,a[b].anchor.longitude];this._pinsFromLatLong[c]||(this._pinsFromLatLong[c]=[]);this._pinsFromLatLong[c].push(a[b])}this.map.setPins(a)},_setLocations:function(a,b){__p&&__p();if(b.seq!=this._requestSeq&&b.seq!=h.ALWAYS_SHOW_REQUEST_SEQ)return;a=null;var c=this.map.getCallout().getAnchor(),d=this.map.getCallout().getOrientation();if(c)for(var e=0;e<b.pins.length;e++)if(c.profileID&&c.profileID===b.pins[e].profileID){a=b.pins[e];break}this._setPins(b.pins);this._setIsExhaustive(b.isExhaustive);!this._activeResultID&&!this._isPostSearch?(this._showListViewer(b.pins,h.LIST_VIEW_NO_HEADER),this._resultPins=b.pins):this._temporaryActiveLocationID||this._showRefreshLink();this._temporaryActiveLocationID&&(this._showLocationCallout(this._temporaryActiveLocationID),this._temporaryActiveLocationID=null);a&&this.map.moveCalloutTo(a,this.map.noPanningStrategy(d));b.pins.length===0&&this._showOverlayMessage(g._("No locations found in this area."))},_showRefreshLink:function(){this.refreshLink&&b("CSS").show(this.refreshLink)},_hideRefreshLink:function(){this.refreshLink&&b("CSS").hide(this.refreshLink)},_showOverlayMessage:function(a){a&&b("DOM").setContent(this.overlayMessage,a),b("CSS").show(this.overlayMessage)},_hideOverlayMessage:function(){b("CSS").hide(this.overlayMessage)},_showListViewer:function(a,c){__p&&__p();a=a.filter(function(a){a=a.group;return!a||a.pins.length==1});if(!a||a.length===0){this._hideListViewer();return}a=a.map(function(a){return a.profileID});a=b("XPagesTimelineMapListViewController").getURIBuilder().setIntVector("list_data",a).setInt("header_type",c).getURI();new(b("AsyncRequest"))().setURI(a).setHandler(function(a){b("DOM").setContent(this.listViewer,a.payload),b("CSS").show(this.listViewer)}.bind(this)).send()},_hideListViewer:function(){b("CSS").hide(this.listViewer)},_guard:function(a){return function(b,c){(!c||!c._instanceid||c._instanceid===this.instanceID)&&a(b,c)}.bind(this)},_subscribe:function(a,c){this._listeners.push(b("Arbiter").subscribe(a,this._guard(c)))}});e.exports=h}),null);
__d("legacy:PagesTimelineMapController",["PagesTimelineMapController"],(function(a,b,c,d,e,f){a.PagesTimelineMapController=b("PagesTimelineMapController")}),3);
__d("NearbyController",["fbt","Arbiter","Button","CSS","DOM","Event","Input","Run","UIPagelet","$"],(function(a,b,c,d,e,f,g){__p&&__p();function a(){}Object.assign(a.prototype,{init:function(a,c,d,e,f,g,h,i){this._pagelet=a,this._throbber=c,this._buttonPrev=d,this._buttonNext=e,this._tokenizer=f,this._resultsText=g,this._hiddenCategories=h,this._mapViewChangeSeq=0,this._viewChangesToIgnore=0,this._pageletSeq=0,this._isThrobbing=!0,this._currentBounds=null,this._map=null,this._addressForm=null,this._addressTextInput=null,this._typeaheadValue=null,this._addressTypeahead=null,this._typeaheadView=null,this._placeIdInput=null,this._radius=null,this._usePager=typeof this._usePager!=="undefined"?this._usePager:!0,this._useMap=typeof i!=="undefined"?i:!0,this._usePager&&this._preparePager(),this._useMap?this._mapLoadedToken=b("Arbiter").subscribe("Nearby/mapLoaded",this._onMapLoaded.bind(this)):this._onLoaded()},initNoPager:function(a,c,d,e,f,g,h){this._usePager=!1;this._pageletContainer=b("$")(a);a=new(b("UIPagelet"))(this._pageletContainer,c,d);this.init(a,e,null,null,f,null,g,h)},_preparePager:function(){b("Event").listen(this._buttonPrev,"click",this._onPrevClick.bind(this)),b("Event").listen(this._buttonNext,"click",this._onNextClick.bind(this))},_onMapLoaded:function(a,c){this._map=c.map,this._addressTypeahead=c.address_typeahead,this._addressTypeahead&&(this._typeaheadView=this._addressTypeahead.getView()),this._placeIdInput=c.place_id_input,this._addressForm=c.address_form,this._addressTextInput=c.address_text_input,b("Run").onLeave(this._onPageTransition.bind(this)),this._mapViewChangeToken=this._map.subscribe("DynamicMap/onViewChangeEnd",this._onMapViewChange.bind(this)),this._addressForm&&b("Event").listen(this._addressForm,"submit",this._onAddressSubmit.bind(this)),this._typeaheadView&&this._typeaheadView.subscribe("select",this._onAddressSubmit.bind(this)),this._onLoaded()},_onLoaded:function(){this._resultsArrivalToken=b("Arbiter").subscribe("Nearby/resultsArrival",this._onResultsArrival.bind(this)),this._headerUpdateToken=b("Arbiter").subscribe("Nearby/resultsArrival",this._executeHeaderUpdate.bind(this)),this._pageReloadToken=b("Arbiter").subscribe("Nearby/pageReload",this._onPageTransition.bind(this)),this._tokenizer&&(this._tokenizer.subscribe("addToken",this._onTypeaheadUpdate.bind(this)),this._tokenizer.subscribe("removeToken",this._onTypeaheadUpdate.bind(this)))},_onPageTransition:function(){this._useMap&&(this._mapLoadedToken.unsubscribe(),this.map.unsubscribe(this._mapViewChangeToken),this._resultsArrivalToken.unsubscribe()),this._pageReloadToken.unsubscribe()},_onMapViewChange:function(a,b){if(this._viewChangesToIgnore>0){this._viewChangesToIgnore-=1;return!1}this._mapViewChangeSeq+=1;var c=this._mapViewChangeSeq;setTimeout(function(){this._execMapViewChange(c,b)}.bind(this),500);return!1},_execMapViewChange:function(a,c){if(a!=this._mapViewChangeSeq)return;this._currentBounds=c;this._addressTextInput&&b("Input").reset(this._addressTextInput);this._addressTypeahead&&this._addressTypeahead.getCore().reset();this._requestViewChange({bounds:c,categories:this._tokenizer&&this._tokenizer.getTokenValues()||this._hiddenCategories,offset:0})},_requestViewChange:function(a){this._pageletSeq+=1,a.seq=this._pageletSeq,this._pagelet.cancel(),this._pagelet.go(a),this._resultsText&&b("CSS").hide(this._resultsText),this._pageletContainer&&b("CSS").hide(this._pageletContainer),b("CSS").show(this._throbber),this._isThrobbing=!0,this._usePager&&this._setPagerButtonsEnabled(!1)},_executeHeaderUpdate:function(a,c){if(c.header_node){a=b("$")("vertex_topic_places_header");b("DOM").setContent(a,c.header_node)}},_onResultsArrival:function(a,c){__p&&__p();if(c.seq!=this._pageletSeq)return;this._useMap&&(this._map.inform("DynamicMap/updatePins",{view_settings:c.view_settings,pins:c.pins,clear_existing:!0,set_view:c.seq===0||!c.bounds},"persistent"),this._typeaheadValue&&this._addressTypeahead&&this._addressTypeahead.getCore().setValue(this._typeaheadValue));c.bounds||(this._viewChangesToIgnore+=1);this._offset=c.offset;this._perpage=c.perpage;this._hasMore=c.has_more;this._radius=c.radius;this._usePager&&this._syncPagerButtons();this._resultsText&&(b("DOM").setContent(this._resultsText,this._getResultsText(c.num_results)),b("CSS").show(this._resultsText));this._pageletContainer&&b("CSS").show(this._pageletContainer);b("CSS").hide(this._throbber);this._isThrobbing=!1},_syncPagerButtons:function(){b("Button").setEnabled(this._buttonPrev,this._offset!==0),b("Button").setEnabled(this._buttonNext,this._hasMore)},_setPagerButtonsEnabled:function(a){[this._buttonPrev,this._buttonNext].map(function(c){b("Button").setEnabled(c,a)})},_onPrevClick:function(a){if(this._isThrobbing||this._offset===0)return;a=Math.max(0,this._offset-this._perpage);this._requestViewChange({bounds:this._currentBounds,categories:this._tokenizer?this._tokenizer.getTokenValues():this._hiddenCategories,near:this._getNear(),offset:a,radius:this._radius,query:this._addressTextInput&&b("Input").getValue(this._addressTextInput)})},_onNextClick:function(a){if(this._isThrobbing||!this._hasMore)return;a=this._offset+this._perpage;this._requestViewChange({bounds:this._currentBounds,categories:this._tokenizer?this._tokenizer.getTokenValues():this._hiddenCategories,near:this._getNear(),offset:a,radius:this._radius,query:this._addressTextInput&&b("Input").getValue(this._addressTextInput)})},_onTypeaheadUpdate:function(a){this._requestViewChange({bounds:this._currentBounds,categories:this._tokenizer&&this._tokenizer.getTokenValues(),near:this._getNear(),query:this._addressTextInput&&b("Input").getValue(this._addressTextInput)})},_onAddressSubmit:function(a){a.kill();if(this._getNear()=="changeCity"||b("Input").isEmpty(this._addressTextInput))return;this._requestViewChange({categories:this._tokenizer&&this._tokenizer.getTokenValues(),near:this._getNear(),query:this._addressTextInput&&this._getFreeform()})},_setTypeaheadValue:function(){this._typeaheadValue=null,this._typeaheadView.getSelection()&&this._typeaheadView.getSelection().uid=="freeform_value"&&(this._typeaheadValue=b("Input").getValue(this._addressTextInput))},_getFreeform:function(){this._typeaheadView&&this._setTypeaheadValue();return b("Input").getValue(this._addressTextInput)},_getNear:function(){var a;this._typeaheadView&&this._typeaheadView.getSelection()?a=this._typeaheadView.getSelection().uid:a=this._placeIdInput&&b("Input").getValue(this._placeIdInput);return a},_getResultsText:function(a){if(a==1)return g._("1 result");else if(a<=this._perpage)return g._({"*":"{number_of_results} results"},[g._param("number_of_results",a,[0])]);else return g._({"*":{"*":"Page {page_number} of about {number_of_pages}"}},[g._param("page_number",this._offset/this._perpage+1,[0]),g._param("number_of_pages",Math.floor(a/this._perpage),[0])])}});e.exports=a}),null);
__d("legacy:nearby-controller",["NearbyController"],(function(a,b,c,d,e,f){a.NearbyController=b("NearbyController")}),3);
__d("TilesDynamicMap",["csx","Arbiter","ArbiterMixin","CSS","DataStore","DOM","FBTilesInfoButton.react","GeoCoordinates","LeafletView","Parent","React","ReactDOM","Run","TilesMapConfig","TilesMapTheme","TilesMapUtils","leaflet","mixin","mod"],(function(a,b,c,d,e,f,g){__p&&__p();var h;a=babelHelpers.inherits(i,b("mixin")(b("ArbiterMixin")));h=a&&a.prototype;function i(a,c,d,e,f){__p&&__p();var g=this;h.constructor.call(this);this.$TilesDynamicMap5=null;this.theme=c.theme;this.map=b("leaflet").map(a,{center:[c.latitude,c.longitude],zoom:c.zoom||1,layers:[b("leaflet").tileLayer(c.urlTemplate||b("TilesMapUtils").getTileURLTemplate(c.language,c.theme),{minZoom:c.minZoom||1,maxZoom:c.maxZoom||18})],zoomControl:c.zoomControl,scrollWheelZoom:c.zoomOnScroll,touchZoom:c.enableZoom,doubleClickZoom:c.enableZoom,boxZoom:c.enableZoom,keyboardZoomOffset:c.enableZoom?1:0,attributionControl:!1,dragging:c.dragging,fadeAnimation:c.enableFadeAnimation}).on({click:function(a){this.inform("DynamicMap/mapClick",{lat:a.latlng.lat,lng:a.latlng.lng},"persistent")}.bind(this)});c.zoomOnScroll&&b("Run").onLeave(function(){this.map.scrollWheelZoom.removeHooks()}.bind(this));var i=[],j=function(a){l=d[a],m=b("leaflet").icon({iconUrl:l.iconUrl,iconRetinaUrl:l.iconRetinaUrl,iconSize:l.iconSize,iconAnchor:l.iconAnchor,popupAnchor:l.popupAnchor}),n=b("leaflet").marker([l.latitude,l.longitude],{draggable:l.draggable,icon:m}).on({drag:function(c){c=c.target.getLatLng();b("Arbiter").inform("DynamicMap/pinDrag",{pin_id:a,latitude:c.lat,longitude:c.lng},"persistent")},dragend:function(c){c=c.target.getLatLng();b("Arbiter").inform("DynamicMap/pinDragEnd",{pin_id:a,latitude:c.lat,longitude:c.lng},"persistent")}}),i.push(n),l.popupContent!=null&&(o={},l.popupMaxWidth!=null&&(o.maxWidth=l.popupMaxWidth),l.popupMaxHeight!=null&&(o.maxHeight=l.popupMaxHeight),n.bindPopup(b("leaflet").popup(o).setContent(l.popupContent))),n.addTo(g.map)};for(var k=0;k<d.length;k++){var l,m,n,o;j(k)}this.markers=i;this.polys={};for(var k=0;k<e.length;k++){j=e[k].points.map(function(a){return[parseFloat(a.latitude),parseFloat(a.longitude)]});var p={stroke:e[k].weight>0?!0:!1,weight:e[k].weight,color:e[k].color,opacity:e[k].opacity,fillColor:e[k].fillColor,fillOpacity:e[k].fillOpacity},q=null;if(e[k].type=="polyline")q=b("leaflet").polyline(j,p);else if(e[k].type=="polygon"){j=[j];for(var r=0;r<e[k].innerRings.length;r++)j.push(e[k].innerRings[r].map(function(a){return[parseFloat(a.latitude),parseFloat(a.longitude)]}));q=b("leaflet").polygon(j,p)}if(e[k].activeFillColor){var s=e[k].fillColor,t=e[k].fillOpacity,u=e[k].activeFillColor,v=e[k].activeFillOpacity;q.on({mouseover:function(a){a.target.setStyle({fillColor:u,fillOpacity:v})}.bind(this),mouseout:function(a){a.target.setStyle({fillColor:s,fillOpacity:t})}.bind(this)})}"id"in e[k]&&(q.id=e[k].id,this.polys[q.id]=q);q.on({mouseover:function(a){this.inform("DynamicMap/polyMouseOver",{target:a.target},"persistent")}.bind(this),mouseout:function(a){this.inform("DynamicMap/polyMouseOut",{target:a.target},"persistent")}.bind(this),click:function(a){this.inform("DynamicMap/polyClick",{target:a.target},"persistent")}.bind(this)});e[k].href&&(q.href=e[k].href,q.on({click:function(a){window.open(a.target.href)}}));e[k].popupContent!==null&&q.bindPopup(b("leaflet").popup({}).setContent(e[k].popupContent));q.addTo(this.map)}this.circles={};for(var r=0;r<f.length;r++){j=b("leaflet").circle([f[r].latitude,f[r].longitude],f[r].radius,{color:f[r].color,weight:f[r].weight,opacity:f[r].opacity,fillColor:f[r].fillColor,fillOpacity:f[r].fillOpacity}).addTo(this.map);p="id"in f[r]?"id:"+f[r].id:r;j.id=f[r].id;j.on({mouseover:function(a){this.inform("DynamicMap/circleMouseOver",{target:a.target},"persistent")}.bind(this),mouseout:function(a){this.inform("DynamicMap/circleMouseOut",{target:a.target},"persistent")}.bind(this),click:function(a){this.inform("DynamicMap/circleClick",{target:a.target},"persistent")}.bind(this)});f[r].href&&(j.href=f[r].href,j.on({click:function(a){window.open(a.target.href)}}));this.circles[p]=j}this.subscribe("DynamicMap/setRadius",function(a,b){a=this.getCircleByIdOrOnly(b.id);a&&(a.setRadius(b.radius),b.center&&this.map.fitBounds(a.getBounds()))}.bind(this));this.subscribe("DynamicMap/toggleCircle",function(a,c){a=this.getCircleByIdOrOnly(c.id);a&&b("CSS").toggle(a.getPath())}.bind(this));this.subscribe("DynamicMap/setCircleLatLng",function(a,b){a=this.getCircleByIdOrOnly(b.id);a&&this.updateObjectLatLng(a,b.lat,b.lng)}.bind(this));this.subscribe("DynamicMap/setPinLatLng",function(a,b){a=this.getMarkerByIdOrOnly(b.id);a&&this.updateObjectLatLng(a,b.lat,b.lng)}.bind(this));var w=this;q=b("leaflet").Control.extend({options:{position:"bottomleft"},initialize:function(a){b("leaflet").Util.setOptions(this,a)},onAdd:function(a){__p&&__p();var c=b("leaflet").DomUtil.create("div",null,this.$TilesDynamicMap1);this.hereLogo=b("leaflet").DomUtil.create("img",null,c);var d=b("TilesMapConfig").LOGO;this.hereLogo.src=d.url;this.hereLogo.width=d.width;this.hereLogo.height=d.height;a.on("resize",function(a){w.$TilesDynamicMap2(a.newSize,this)},this);w.$TilesDynamicMap2(a.getSize(),this);return c}});var x=new q();this.map.on("moveend",function(){this.$TilesDynamicMap2(this.map.getSize(),x)},this);this.map.addControl(x);if(c.showReportButton){k=document.createElement("span");a.appendChild(k);this.$TilesDynamicMap3(k)}b("DataStore").set(a,"TilesDynamicMap",this);this.inform("DynamicMap/onInit",{},"persistent");this.attributions=[]}i.prototype.on=function(a,b,c){"use strict";return this.map.on(a,b,c)};i.prototype.off=function(a,b,c){"use strict";return this.map.off(a,b,c)};i.prototype.fitBounds=function(a){"use strict";this.map.fitBounds(a)};i.prototype.getCenter=function(){"use strict";var a=this.map.getCenter();return{latitude:a.lat,longitude:a.lng}};i.prototype.getZoom=function(){"use strict";return this.map.getZoom()};i.prototype.setZoom=function(a){"use strict";this.setView({center:this.map.getCenter(),zoom:a,animate:!1})};i.prototype.getWidth=function(){"use strict";return this.map.getSize().x};i.prototype.getHeight=function(){"use strict";return this.map.getSize().y};i.prototype.invalidateSize=function(){"use strict";this.map.invalidateSize(!1)};i.prototype.setView=function(a){"use strict";if(a.centerOffset){var b=this.map.project(a.center,a.zoom);b=b.subtract(a.centerOffset);a.center=this.map.unproject(b,a.zoom)}this.map.setView(a.center,a.zoom,{animate:a.animate});this.map.fireEvent("movestart");this.map.fireEvent("moveend")};i.prototype.poly=function(a){"use strict";return this.polys[a]};i.prototype.onInit=function(a){"use strict";a()};i.prototype.getMap=function(){"use strict";return this};i.prototype.getBounds=function(){"use strict";return this.map.getBounds()};i.prototype.mapToPixel=function(a){"use strict";var b=this.map.getPixelBounds().min;return a.sub(b.x,b.y)};i.prototype.pixelToMap=function(a){"use strict";var c=this.map.getPixelBounds().min;a=a.add(c.x,c.y);a.x=b("mod")(a.x,this.$TilesDynamicMap4());return a};i.prototype.tryPixelToLocation=function(a){"use strict";return this.map.containerPointToLatLng(a)};i.prototype.getCircleByIdOrOnly=function(a){"use strict";if(a)return this.circles["id:"+a];else{a=Object.keys(this.circles);if(a.length==1)return this.circles[a[0]]}return null};i.prototype.getMarkerByIdOrOnly=function(a){"use strict";if(a!=null)return this.markers[a];else if(this.markers.length===1)return this.markers[0];return null};i.prototype.updateObjectLatLng=function(a,c,d){"use strict";var e=a.getLatLng();c=c||e.lat;d=d||e.lng;a.setLatLng(b("leaflet").latLng(c,d))};i.prototype.$TilesDynamicMap4=function(){"use strict";return 512*Math.pow(2,this.map.getZoom()-1)};i.prototype.componentWillUnmount=function(){"use strict";this.$TilesDynamicMap5&&this.$TilesDynamicMap5.abort()};i.prototype.$TilesDynamicMap2=function(a,c){"use strict";if(a.x<b("TilesMapConfig").MIN_SIZE_FOR_ATTRIBUTION||a.y<b("TilesMapConfig").MIN_SIZE_FOR_ATTRIBUTION)c.hereLogo.hidden=!0;else if(this.theme!==""&&this.theme!==b("TilesMapTheme").DEFAULT&&this.theme!==b("TilesMapTheme").ROAD_MASK_OSM_EDITING)c.hereLogo.hidden=!0,this.attributions=["osm"];else{a=this.getBounds();this.$TilesDynamicMap5=b("TilesMapUtils").getMapProviderForAttributionByViewPort(a,this.map.getZoom(),function(a){this.$TilesDynamicMap5=null,c.hereLogo.hidden=!(a.length==1&&a.includes("here")),this.attributions=a}.bind(this))}};i.prototype.$TilesDynamicMap3=function(a){"use strict";__p&&__p();var c=this;a=b("leaflet").Control.extend({options:{position:"bottomright"},infoButton:a,initialize:function(a){b("leaflet").Util.setOptions(this,a)},onAdd:function(a){var d=function(){var d=a.getCenter();d=new(b("LeafletView"))({center:new(b("GeoCoordinates"))(d.lat,d.lng),zoom:a.getZoom()});return{hereReportUrl:b("TilesMapUtils").getHereReporterToolUrl(d),mapSources:c.attributions,mapUrl:null,mapBounds:a.getBounds(),zoom:a.getZoom()}};b("ReactDOM").render(b("React").createElement(b("FBTilesInfoButton.react"),{mapInfoCallback:d}),this.infoButton);return this.infoButton}});a=new a();this.map.addControl(a)};i.getInstance=function(a){"use strict";var c=b("Parent").bySelector(a,"._49nx");if(!c){a=b("DOM").scry(a,"._49nx");c=a.length>0?a[0]:null}return c?b("DataStore").get(c,"TilesDynamicMap"):null};i.poke=function(a){"use strict";a=i.getInstance(a);a&&a.invalidateSize()};e.exports=i}),null);